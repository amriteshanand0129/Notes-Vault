<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <script src="/js/script.js"></script>
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .heading {
            color: grey;
        }

        .pendingContributionsOuter {
            margin: 20px;
        }
        .pendingContributionsInner {
            width: 50%;
            margin: auto;
            margin-top: 10px;
            margin-bottom: 10px;
            border: 1px solid grey;
            border-radius: 10px;
            padding: 30px;
            font-size: large;
            line-height: 40px;
        }
        .pendingContributionsInner:hover {
            border: 1px solid black;
        }

        .status {
            border-radius: 10px;
            float: right;
        }
        .pendingStatus {
            border-radius: 10px;
            background-color: rgba(255, 255, 0, 0.7);
            padding: 10px 20px;
        }
        .approvedStatus {
            border-radius: 10px;
            padding: 10px 20px;
            background-color: rgba(127, 255, 0, 0.7);
        }
        .rejectedStatus {
            border-radius: 10px;
            padding: 10px 20px;
            background-color: rgba(127, 0, 0, 0.7);
        }

        .approvedContributionsOuter {
            margin: 20px;
        }
        .approvedContributionsInner {
            width: 50%;
            margin: auto;
            margin-top: 10px;
            margin-bottom: 10px;
            border: 1px solid grey;
            border-radius: 10px;
            padding: 30px;
            font-size: large;
            line-height: 40px;

        }
        .approvedContributionsInner:hover {
            border: 1px solid black;
        }

        .rejectedContributionsOuter {
            margin: 20px;
        }
        .rejectedContributionsInner {
            width: 50%;
            margin: auto;
            margin-top: 10px;
            margin-bottom: 10px;
            border: 1px solid grey;
            border-radius: 10px;
            padding: 30px;
            font-size: large;
            line-height: 40px;
        }
        .rejectedContributionsInner:hover {
            border: 1px solid black;
        }
    </style>
    <script>
        function logout() {
    document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
    sessionStorage.setItem('warning', "Logged Out Succesfully")
    window.location.href = '/'; 
}
    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg border-bottom border-body" style="padding: 10px;">
        <div class="container-fluid">
            <img src="/images/Logo.png" alt="Logo" height="60px" width="220px">
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav" style="margin-left: auto;">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/resources">Resources</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contact Us</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <%= user.name %>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item active" href="/profile">Profile</a></li>
                            <li><a class="dropdown-item" onclick="logout()" style="cursor:pointer;">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <h2> <%= user.name %>
    </h2>
    <div class="pendingContributionsOuter">
        <% pending_contributions.forEach(pending_contribution=> { %>
            <div class="pendingContributionsInner">
                <div class="status">
                    Status: <span class="pendingStatus">Pending</span>
                </div>
                <span class="heading">Subject Code: </span>
                <%= pending_contribution.subject_code %>
                <br>
                <span class="heading">Subject Name: </span>
                <%= pending_contribution.subject_name %>
                <br>
                <span class="heading">File Name: </span>
                <%= pending_contribution.file_name %>
                <br>
                <span class="heading">Description:</span>
                <%= pending_contribution.description %>
                <br>
                <span class="heading">Uploaded On:</span>
                <%= (new Date(pending_contribution.createdAt)).toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric'
                }) %>
                <br>
                <a href="/download_pendingfile/<%= pending_contribution._id %>"
                    download="filename"><button type="button" class="btn btn-outline-info">Download
                        File</button></a>

            </div>
        <% }) %>
    </div>
    <div class="approvedContributionsOuter">
        <% approved_contributions.forEach(approved_contribution=> { %>
            <div class="approvedContributionsInner">
                <div class="status">
                    Status: <span class="approvedStatus">Approved</span> 
                </div>
                <span class="heading">Subject Code: </span>
                    <%= approved_contribution.subject_code %>
                <br>
                <span class="heading">Subject Name: </span>
                    <%= approved_contribution.subject_name %>
                <br>
                <span class="heading">File Name: </span>
                    <%= approved_contribution.file_name %>
                <br>
                <span class="heading">Description:</span>
                    <%= approved_contribution.description %>
                <br>
                <span class="heading">Uploaded On:</span>
                <%= (new Date(approved_contribution.uploadedOn)).toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric'
                }) %>
                <br>
                <span class="heading">Approved On:</span>
                <%= (new Date(approved_contribution.createdAt)).toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric'
                }) %>
                <br>
                <a href="/downloadfile/<%= approved_contribution._id %>"
                    download="filename"><button type="button" class="btn btn-outline-info">Download
                        File</button></a>
            </div>
            <% }) %>
    </div>
    <div class="rejectedContributionsOuter">
        <% rejected_contributions.forEach(rejected_contribution=> { %>
            <div class="rejectedContributionsInner">
                <div class="status">
                    Status: <span class="rejectedStatus">Rejected</span>
                </div>
                <span class="heading">Subject Code: </span>
                    <%= rejected_contribution.subject_code %>
                <br>
                <span class="heading">Subject Name: </span>
                    <%= rejected_contribution.subject_name %>
                <br>
                <span class="heading">File Name: </span>
                    <%= rejected_contribution.file_name %>
                <br>
                <span class="heading">Description:</span>
                    <%= rejected_contribution.description %>
                <br>
                <span class="heading">Uploaded On:</span>                    
                </h4>
                <br>
                <span class="heading">Reason:</span>
                    <%= rejected_contribution.remarks %>
            </div>
            <% }) %>
    </div>        
</body>
</html>